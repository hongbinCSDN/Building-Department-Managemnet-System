DROP VIEW MWMS2.ACACTION;

CREATE OR REPLACE VIEW MWMS2.ACACTION
AS
select actionId, actionName, displayName
    from p_acActionX;

DROP VIEW MWMS2.ACRESOURCE;

CREATE OR REPLACE VIEW MWMS2.ACRESOURCE
AS
select resourceId, resourceName, resourceTypeId, description
    from p_acResourceX;

DROP VIEW MWMS2.ACRESOURCETYPE;

CREATE OR REPLACE VIEW MWMS2.ACRESOURCETYPE
AS
select resourceTypeId, resourceTypeName, resourceTypeDisplayName
    from p_acResourceTypeX;

DROP VIEW MWMS2.ACROLE;

CREATE OR REPLACE VIEW MWMS2.ACROLE
AS
select roleId, roleName, description, parameter, filter, ruleId, entities, ruleConflict
    from p_acRoleX;

DROP VIEW MWMS2.ACROLEGROUP;

CREATE OR REPLACE VIEW MWMS2.ACROLEGROUP
AS
select roleGroupId, groupId, roleId
    from p_acRoleGroupX;

DROP VIEW MWMS2.ACROLERESOURCE;

CREATE OR REPLACE VIEW MWMS2.ACROLERESOURCE
AS
select resourceId, roleResourceId, roleId, actionId
    from p_acRoleResourceX;

DROP VIEW MWMS2.ACROLEUSER;

CREATE OR REPLACE VIEW MWMS2.ACROLEUSER
AS
select  roleUserId, userId, roleId
    from p_acRoleUserX;

DROP VIEW MWMS2.ACUSER;

CREATE OR REPLACE VIEW MWMS2.ACUSER
AS
select USERID, USERNAME, FIRSTNAME, LASTNAME, EMAIL, PASSWORD, LOGINSTATUS, USEROP, DEPARTMENT,ACTIVE
    from P_USERS;

DROP VIEW MWMS2.ACUSERGROUP;

CREATE OR REPLACE VIEW MWMS2.ACUSERGROUP
AS
select USERGROUPID, USERID, GROUPID
    from p_acUserGroupX;

DROP VIEW MWMS2.APPLICANT_EFORM;

CREATE OR REPLACE VIEW MWMS2.APPLICANT_EFORM
AS
SELECT UUID, SURNAME, GIVEN_NAME_ON_ID, GENDER, CHINESE_NAME, IS_POOLING, CREATED_BY, CREATED_DATE, MODIFIED_BY, MODIFIED_DATE, TITLE_ID FROM c_APPLICANT;

DROP VIEW MWMS2.V_EFSS_APPLICANT;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_APPLICANT
AS
SELECT 
ID , FORMTYPE , FORM_ID , HKID , PASSPORTNO , SURNAME , GIVENNAME , CHNNAME , SEX , ROLE 
, COMLANG , LASTUPDATE , CREATEDATE
FROM c_EFSS_APPLICANT;

DROP VIEW MWMS2.V_EFSS_APPLICANT_MW_CAPA;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_APPLICANT_MW_CAPA
AS
SELECT 
ID , APPLICANT_ID , CLSTYPEA , CLSTYPEB , CLSTYPEC , CLSTYPED , CLSTYPEE , CLSTYPEF , CLSTYPEG , APPDATE , APPFORM , LASTUPDATE , CREATEDATE
FROM c_EFSS_APPLICANT_MW_CAPA;

DROP VIEW MWMS2.V_EFSS_BA24;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_BA24
AS
SELECT 
ID , FORMTYPE , FILEREF , ADDRESS_LINE1 , ADDRESS_LINE2 , ADDRESS_LINE3 , ADDRESS_LINE4 
, ADDRESS_LINE5 , TELNO1 , TELNO2 , TELNO3 , FAXNO1 , FAXNO2 , EMAIL , LASTUPDDATE , 
CREATEDATE , APPLICATIONDATE,
C_ADDRESS_LINE1,
C_ADDRESS_LINE2,
C_ADDRESS_LINE3,
C_ADDRESS_LINE4,
C_ADDRESS_LINE5
FROM c_EFSS_BA24;

DROP VIEW MWMS2.V_EFSS_COMPANY;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_COMPANY
AS
SELECT 
ID , FORMTYPE , CHNCOMPNAME , ENGCOMPNAME , FILEREFTYPE , FILEREF , ADDRESS_LINE1 , 
ADDRESS_LINE2 , ADDRESS_LINE3 , ADDRESS_LINE4 , ADDRESS_LINE5 , TELNO , FAXNO , EMAIL , 
BRNO , COMTYPE , APPNAME , LASTUPDDATE , CREATEDATE , APPLICATIONDATE ,
C_ADDRESS_LINE1,
C_ADDRESS_LINE2,
C_ADDRESS_LINE3,
C_ADDRESS_LINE4,
C_ADDRESS_LINE5
FROM c_EFSS_COMPANY;

DROP VIEW MWMS2.V_EFSS_MWC;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_MWC
AS
SELECT 
ID , FORMTYPE , FILEREF , BRNO , ENGCOMNAME , CHNCOMNAME , COMTYPE , APPNAME , 
E_ADDRESS_LINE1 , E_ADDRESS_LINE2 , E_ADDRESS_LINE3 , E_ADDRESS_LINE4 , E_ADDRESS_LINE5 
, C_ADDRESS_LINE1 , C_ADDRESS_LINE2 , C_ADDRESS_LINE3 , C_ADDRESS_LINE4 , 
C_ADDRESS_LINE5 , TELNO1 , TELNO2 , TELNO3 , FAXNO1 , FAXNO2 , EMAIL , LASTUPDDATE , 
CREATEDATE , APPLICATIONDATE
FROM c_EFSS_MWC;

DROP VIEW MWMS2.V_EFSS_MWCW;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_MWCW
AS
SELECT 
ID , FORMTYPE , FILEREF , CORR_E_ADDRESS_LINE1 , CORR_E_ADDRESS_LINE2 , CORR_E_ADDRESS_LINE3 , CORR_E_ADDRESS_LINE4 , CORR_E_ADDRESS_LINE5 , CORR_C_ADDRESS_LINE1 , CORR_C_ADDRESS_LINE2 , CORR_C_ADDRESS_LINE3 , CORR_C_ADDRESS_LINE4 , CORR_C_ADDRESS_LINE5 , COMP_E_ADDRESS_LINE1 , COMP_E_ADDRESS_LINE2 , COMP_E_ADDRESS_LINE3 , COMP_E_ADDRESS_LINE4 , COMP_E_ADDRESS_LINE5 , COMP_C_ADDRESS_LINE1 , COMP_C_ADDRESS_LINE2 , COMP_C_ADDRESS_LINE3 , COMP_C_ADDRESS_LINE4 , COMP_C_ADDRESS_LINE5 , TELNO1 , TELNO2 , TELNO3 , FAXNO1 , FAXNO2 , EMAIL , LASTUPDDATE , CREATEDATE , APPLICATIONDATE
FROM c_EFSS_MWCW;

DROP VIEW MWMS2.V_EFSS_PROFESSIONAL;

CREATE OR REPLACE VIEW MWMS2.V_EFSS_PROFESSIONAL
AS
SELECT 
ID , FORMTYPE , CATCODE , FILEREF , CERTNO , ADDRESS_LINE1 , ADDRESS_LINE2 , 
ADDRESS_LINE3 , ADDRESS_LINE4 , ADDRESS_LINE5 , FAXNO , EMAIL , OFFICE_ADDRESS_LINE1 , 
OFFICE_ADDRESS_LINE2 , OFFICE_ADDRESS_LINE3 , OFFICE_ADDRESS_LINE4 , 
OFFICE_ADDRESS_LINE5 , TELNO1 , TELNO2 , EMERGNO1 , EMERGNO2 , SPECSIGN , BSCODE1 , 
BSCODE2 , BSCODE3 , BSCODE4 , ISINTERESTQP , LANG , CREATEDATE , LASTUPDDATE , 
APPLICATIONDATE,
C_ADDRESS_LINE1,
C_ADDRESS_LINE2,
C_ADDRESS_LINE3,
C_ADDRESS_LINE4,
C_ADDRESS_LINE5,
C_OFFICE_ADDRESS_LINE1,
C_OFFICE_ADDRESS_LINE2,
C_OFFICE_ADDRESS_LINE3,
C_OFFICE_ADDRESS_LINE4,
C_OFFICE_ADDRESS_LINE5
FROM c_EFSS_PROFESSIONAL;

DROP VIEW MWMS2.V_O_EFSS_ATTACHMENT_LIST;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_ATTACHMENT_LIST
AS
SELECT 
ID,
SUBMISSION_NO,
FORM_TYPE,
ATT_TYPE,
DOC_TYPE,
FILE_NAME ,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM B_EFSS_ATTACHMENT_LIST;

DROP VIEW MWMS2.V_O_EFSS_SC01;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC01
AS
SELECT 
ID , 
SUBMISSION_NO , 
SIGNBOARD_LOC , 
SIGNBOARD_OWNER_CHI_NAME , 
SIGNBOARD_OWNER_ENG_NAME , 
SIGNBOARD_OWNER_BR_NO , 
SIGNBOARD_OWNER_FAX_NO ,
 SIGNBOARD_OWNER_TEL_NO , 
 SIGNBOARD_OWNER_EMAIL , 
 BIZ_CORR_ADDR_FLAT , 
 BIZ_CORR_ADDR_FLOOR , 
 BIZ_CORR_ADDR_BLOCK , 
 BIZ_CORR_ADDR_BLDG_ESTATE , 
 BIZ_CORR_ADDR_STREET_NAME , 
 BIZ_CORR_ADDR_STREET_NO , 
 BIZ_CORR_ADDR_DIST , 
 BIZ_CORR_ADDR_REGION , 
 OWER_COP_CORR_ADDR_FLAT , 
 OWER_COP_CORR_ADDR_FLOOR ,
  OWER_COP_CORR_ADDR_BLOCK , 
  OWER_COP_CORR_ADDR_BLDG_ESTATE ,
   OWER_COP_CORR_ADDR_STREET_NAME , 
   OWER_COP_CORR_ADDR_STREET_NO , 
   OWER_COP_CORR_ADDR_DIST , 
   OWER_COP_CORR_ADDR_REGION , 
   PAW_CHI_NAME , 
   PAW_ENG_NAME , 
   AP_CHI_NAME , 
   AP_ENG_NAME , 
   AP_CERT_REG_NO , 
   AP_REG_EXPIRY_DATE , 
   AP_SIGN_DATE ,
    RSE_CHI_NAME , 
    RSE_ENG_NAME , 
    RSE_CERT_REG_NO ,
     RSE_REG_EXPIRY_DATE , 
     RSE_SIGN_DATE,
     BD_BLK_ID,
     BD_FILE_REF,
SIGNBOARD_ADDR_FLAT ,
 SIGNBOARD_ADDR_FLOOR  ,
 SIGNBOARD_ADDR_BLOCK   ,
 SIGNBOARD_ADDR_BLDG_ESTATE  ,
 SIGNBOARD_ADDR_STREET_NAME  ,
 SIGNBOARD_ADDR_STREET_NO  ,
 SIGNBOARD_ADDR_DIST  ,
 SIGNBOARD_ADDR_REGION	,
INSPECTION_DATE,
PRC_CHI_NAME,
PRC_ENG_NAME,
PRC_AS_CHI_NAME,
PRC_AS_ENG_NAME,
PRC_CERT_REG_NO,
PRC_REG_EXPIRY_DATE,
PRC_SIGN_DATE,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY,
WITH_ALTER_STRENGTH
FROM MWMS2.B_EFSS_SC01;

DROP VIEW MWMS2.V_O_EFSS_SC01_MW_ITEM;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC01_MW_ITEM
AS
SELECT 
ID , SUBMISSION_NO , CORR_MW_ITEMS_NO , CORR_MW_ITEMS_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC01_MW_ITEM;

DROP VIEW MWMS2.V_O_EFSS_SC01_VALIDATION;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC01_VALIDATION
AS
SELECT 
ID , SUBMISSION_NO , QUANTITY , VALIDATION_NO , VALIDATION_DESC , CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC01_VALIDATION;

DROP VIEW MWMS2.V_O_EFSS_SC01C;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC01C
AS
SELECT 
ID , 
SUBMISSION_NO , 
SIGNBOARD_LOC ,
 PRC_CHI_NAME , 
 PRC_ENG_NAME , 
 PRC_AS_CHI_NAME , 
 PRC_AS_ENG_NAME , 
 PRC_FAX_NO , 
 PRC_TEL_NO , 
 PRC_CERT_REG_NO , 
 PRC_REG_EXPIRY_DATE , 
 PRC_SIGN_DATE , 
 AP_REG_EXPIRY_DATE , 
 AP_SIGN_DATE , 
 AP_CERT_REG_NO , 
 AP_CHI_NAME , 
 AP_ENG_NAME , 
 RSE_REG_EXPIRY_DATE , 
 RSE_SIGN_DATE ,
  RSE_CERT_REG_NO , 
  RSE_CHI_NAME , 
  RSE_ENG_NAME,
  BD_BLK_ID,
  BD_FILE_REF,
COMMENCEMENT_DATE,
COMPLETION_DATE,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY,
WITH_ALTER_STRENGTH
FROM MWMS2.B_EFSS_SC01C;

DROP VIEW MWMS2.V_O_EFSS_SC01C_MW_ITEM;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC01C_MW_ITEM
AS
SELECT 
ID , SUBMISSION_NO , CORR_MW_ITEMS_NO , CORR_MW_ITEMS_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC01C_MW_ITEM;

DROP VIEW MWMS2.V_O_EFSS_SC01C_VALIDATION;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC01C_VALIDATION
AS
SELECT 
ID , SUBMISSION_NO , QUANTITY , VALIDATION_NO , VALIDATION_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC01C_VALIDATION;

DROP VIEW MWMS2.V_O_EFSS_SC02;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC02
AS
SELECT 
ID ,
 SUBMISSION_NO , 
 SIGNBOARD_LOC ,
  SIGNBOARD_OWNER_CHI_NAME ,
   SIGNBOARD_OWNER_ENG_NAME ,
    SIGNBOARD_OWNER_BR_NO ,
     SIGNBOARD_OWNER_FAX_NO ,
      SIGNBOARD_OWNER_TEL_NO ,
       SIGNBOARD_OWNER_EMAIL ,
        BIZ_CORR_ADDR_FLAT ,
         BIZ_CORR_ADDR_FLOOR ,
          BIZ_CORR_ADDR_BLOCK ,
           BIZ_CORR_ADDR_BLDG_ESTATE ,
            BIZ_CORR_ADDR_STREET_NAME ,
             BIZ_CORR_ADDR_STREET_NO , 
             BIZ_CORR_ADDR_DIST , 
             BIZ_CORR_ADDR_REGION , 
             OWER_COP_CORR_ADDR_FLAT , 
             OWER_COP_CORR_ADDR_FLOOR ,
              OWER_COP_CORR_ADDR_BLOCK ,
               OWER_COP_CORR_ADDR_BLDG_ESTATE , 
               OWER_COP_CORR_ADDR_STREET_NAME ,
                OWER_COP_CORR_ADDR_STREET_NO ,
                 OWER_COP_CORR_ADDR_DIST , 
                 OWER_COP_CORR_ADDR_REGION ,
                  PAW_CHI_NAME , 
                  PAW_ENG_NAME , 
                  APP_TYPE , 
                  APP_CHI_NAME , 
                  APP_CERT_REG_NO ,
                   APP_ENG_NAME , 
                   APP_REG_EXPIRY_DATE , 
                   APP_SIGN_DATE , 
                   PRC_AS_CHI_NAME ,
                    PRC_AS_ENG_NAME , 
                    PRC_CHI_NAME , 
                    PRC_ENG_NAME , 
                    PRC_CERT_REG_NO ,
                     PRC_REG_EXPIRY_DATE , 
                     PRC_SIGN_DATE,
                      BD_BLK_ID,
                        BD_FILE_REF,
SIGNBOARD_ADDR_FLAT ,
 SIGNBOARD_ADDR_FLOOR  ,
 SIGNBOARD_ADDR_BLOCK   ,
 SIGNBOARD_ADDR_BLDG_ESTATE  ,
 SIGNBOARD_ADDR_STREET_NAME  ,
 SIGNBOARD_ADDR_STREET_NO  ,
 SIGNBOARD_ADDR_DIST  ,
 SIGNBOARD_ADDR_REGION    ,
INSPECTION_DATE,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY ,
WITH_ALTER_STRENGTH
FROM MWMS2.B_EFSS_SC02;

DROP VIEW MWMS2.V_O_EFSS_SC02_MW_ITEM;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC02_MW_ITEM
AS
SELECT 
ID , SUBMISSION_NO , CORR_MW_ITEMS_NO , CORR_MW_ITEMS_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC02_MW_ITEM;

DROP VIEW MWMS2.V_O_EFSS_SC02_VALIDATION;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC02_VALIDATION
AS
SELECT 
ID , SUBMISSION_NO , QUANTITY , VALIDATION_NO , VALIDATION_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC02_VALIDATION;

DROP VIEW MWMS2.V_O_EFSS_SC02C;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC02C
AS
SELECT 
ID , 
SUBMISSION_NO ,
 SIGNBOARD_LOC , 
 PRC_CHI_NAME ,
  PRC_ENG_NAME , 
  PRC_CERT_REG_NO , 
  PRC_AS_CHI_NAME , 
  PRC_AS_ENG_NAME , 
  PRC_REG_EXPIRY_DATE , 
  PRC_SIGN_DATE , 
  PRC_FAX_NO , 
  PRC_TEL_NO , 
  APP_TYPE , 
  APP_CHI_NAME , 
  APP_ENG_NAME , 
  APP_CERT_REG_NO ,
   APP_REG_EXPIRY_DATE ,
    APP_SIGN_DATE,
    BD_BLK_ID,
     BD_FILE_REF,
COMMENCEMENT_DATE,
COMPLETION_DATE,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY,
WITH_ALTER_STRENGTH
FROM MWMS2.B_EFSS_SC02C;

DROP VIEW MWMS2.V_O_EFSS_SC02C_MW_ITEM;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC02C_MW_ITEM
AS
SELECT 
ID , SUBMISSION_NO , CORR_MW_ITEMS_NO , CORR_MW_ITEMS_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY
FROM MWMS2.B_EFSS_SC02C_MW_ITEM;

DROP VIEW MWMS2.V_O_EFSS_SC02C_VALIDATION;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC02C_VALIDATION
AS
SELECT 
ID , SUBMISSION_NO , QUANTITY , VALIDATION_NO , VALIDATION_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY
FROM MWMS2.B_EFSS_SC02C_VALIDATION;

DROP VIEW MWMS2.V_O_EFSS_SC03;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC03
AS
SELECT 
ID , 
SUBMISSION_NO , 
SIGNBOARD_LOC , 
SIGNBOARD_OWNER_CHI_NAME , 
SIGNBOARD_OWNER_ENG_NAME , 
SIGNBOARD_OWNER_BR_NO , 
SIGNBOARD_OWNER_FAX_NO , 
SIGNBOARD_OWNER_TEL_NO , 
SIGNBOARD_OWNER_EMAIL , 
BIZ_CORR_ADDR_FLAT , 
BIZ_CORR_ADDR_FLOOR , 
BIZ_CORR_ADDR_BLOCK , 
BIZ_CORR_ADDR_BLDG_ESTATE ,
 BIZ_CORR_ADDR_STREET_NAME , 
 BIZ_CORR_ADDR_STREET_NO , 
 BIZ_CORR_ADDR_DIST , 
 BIZ_CORR_ADDR_REGION , 
 OWER_COP_CORR_ADDR_FLAT ,
  OWER_COP_CORR_ADDR_FLOOR , 
  OWER_COP_CORR_ADDR_BLOCK , 
  OWER_COP_CORR_ADDR_BLDG_ESTATE , 
  OWER_COP_CORR_ADDR_STREET_NAME ,
   OWER_COP_CORR_ADDR_STREET_NO , 
   OWER_COP_CORR_ADDR_DIST , 
   OWER_COP_CORR_ADDR_REGION , 
   PAW_CHI_NAME , 
   PAW_ENG_NAME , 
   APP_TYPE , 
   APP_CHI_NAME , 
   APP_CERT_REG_NO , 
   APP_ENG_NAME , 
   APP_REG_EXPIRY_DATE ,
    APP_SIGN_DATE , 
    PRC_CHI_NAME , 
    PRC_ENG_NAME , 
    PRC_AS_CHI_NAME , 
    PRC_AS_ENG_NAME , 
    PRC_CERT_REG_NO , 
    PRC_REG_EXPIRY_DATE , 
    PRC_SIGN_DATE,
    BD_BLK_ID,
    BD_FILE_REF,
SIGNBOARD_ADDR_FLAT ,
 SIGNBOARD_ADDR_FLOOR  ,
 SIGNBOARD_ADDR_BLOCK   ,
 SIGNBOARD_ADDR_BLDG_ESTATE  ,
 SIGNBOARD_ADDR_STREET_NAME  ,
 SIGNBOARD_ADDR_STREET_NO  ,
 SIGNBOARD_ADDR_DIST  ,
 SIGNBOARD_ADDR_REGION ,
INSPECTION_DATE,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY,
WITH_ALTER_STRENGTH
FROM MWMS2.B_EFSS_SC03;

DROP VIEW MWMS2.V_O_EFSS_SC03_MW_ITEM;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC03_MW_ITEM
AS
SELECT 
ID , SUBMISSION_NO , CORR_MW_ITEMS_NO , CORR_MW_ITEMS_DESC,CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC03_MW_ITEM;

DROP VIEW MWMS2.V_O_EFSS_SC03_VALIDATION;

CREATE OR REPLACE VIEW MWMS2.V_O_EFSS_SC03_VALIDATION
AS
SELECT 
ID , SUBMISSION_NO , QUANTITY , VALIDATION_NO , VALIDATION_DESC,
CREATED_DATE,
CREATED_BY,
MODIFIED_DATE,
MODIFIED_BY 
FROM MWMS2.B_EFSS_SC03_VALIDATION;

DROP VIEW MWMS2.VQPEXPORT;

CREATE OR REPLACE VIEW MWMS2.VQPEXPORT
AS
SELECT 
CAST('Registration No.' AS VARCHAR2(20)) AS CERTIFICATION_NO,
CAST('English Name' AS VARCHAR2(150)) AS english_name,
CAST('Chinese Name' AS nVARCHAR2(20)) AS chinese_name,
CAST('English Address Line 1' AS nVARCHAR2(40)) AS english_line1,
CAST('English Address Line 2' AS nVARCHAR2(40)) AS english_line2,
CAST('English Address Line 3' AS nVARCHAR2(40)) AS english_line3,
CAST('English Address Line 4' AS nVARCHAR2(40)) AS english_line4,
CAST('English Address Line 5' AS nVARCHAR2(40)) AS english_line5,
CAST('Chinese Address Line 1' AS nVARCHAR2(40)) AS chinese_line1,
CAST('Chinese Address Line 2' AS nVARCHAR2(40)) AS chinese_line2,
CAST('Chinese Address Line 3' AS nVARCHAR2(40)) AS chinese_line3,
CAST('Chinese Address Line 4' AS nVARCHAR2(40)) AS chinese_line4,
CAST('Chinese Address Line 5' AS nVARCHAR2(40)) AS chinese_line5,
CAST('Fax No. 1' AS VARCHAR2(20)) AS fAX_NO1,
CAST('Fax No. 2' AS VARCHAR2(20)) AS fAX_NO2
FROM DUAL

UNION all

SELECT "CERTIFICATION_NO","ENGLISH_NAME","CHINESE_NAME","ENGLISH_LINE1","ENGLISH_LINE2","ENGLISH_LINE3","ENGLISH_LINE4","ENGLISH_LINE5","CHINESE_LINE1","CHINESE_LINE2","CHINESE_LINE3","CHINESE_LINE4","CHINESE_LINE5","FAX_NO1","FAX_NO2" FROM (

SELECT distinct
CERTIFICATION_NO,
english_name, 
chinese_name,
english_line1,
english_line2,
english_line3,
english_line4,
english_line5,
chinese_line1,
chinese_line2,
chinese_line3,
chinese_line4,
chinese_line5,
fAX_NO1,
fax_no2
FROM (

 SELECT sys_guid() AS uuid, 
	C.CERTIFICATION_NO,
	trim( APP.SURNAME||' '|| APP.GIVEN_NAME_ON_ID) AS english_name,
	trim(APP.CHINESE_NAME) AS chinese_name,	
	eng.address_line1 AS english_line1,
	eng.address_line2 AS english_line2,
	eng.address_line3 AS english_line3,
	eng.address_line4 AS english_line4,
	eng.address_line5 AS english_line5,
	chi.address_line1 AS chinese_line1,
	chi.address_line2 AS chinese_line2,
	chi.address_line3 AS chinese_line3,
	chi.address_line4 AS chinese_line4,
	chi.address_line5 AS chinese_line5,
  	A.FAX_NO1,
  	A.FAX_NO2
	FROM c_IND_CERTIFICATE C, c_S_CATEGORY_CODE CAT, c_S_SYSTEM_VALUE CATGRP, 
		 c_APPLICANT APP, c_IND_APPLICATION A ,c_S_SYSTEM_VALUE statusCode
		 ,c_ADDRESS eng,  c_ADDRESS chi
	WHERE  
		 C.CATEGORY_ID= cat.UUID 
		 AND C.MASTER_ID=A.UUID 
		 AND A.REGISTRATION_TYPE= 'IP'
		 AND CATGRP.UUID = CAT.CATEGORY_GROUP_ID  
 		 AND CATGRP.UUID=(SELECT  CATEGORY_GROUP_ID FROM c_S_CATEGORY_CODE SCC WHERE  SCC.CODE='AP(A)')
		 AND A.APPLICANT_ID =APP.UUID 
		 AND statusCode.UUID=C.application_status_id 
			  AND (statusCode.CODE= '1' or (C.RETENTION_APPLICATION_DATE IS NOT NULL))
		
		 AND C.CERTIFICATION_NO IS NOT NULL 
		 AND (  
	  		 (C.EXPIRY_DATE IS NOT NULL and C.EXPIRY_DATE >= CURRENT_DATE ) or 
			 (C.RETENTION_APPLICATION_DATE > TO_DATE('20040831', 'yyyymmdd') and (C.EXPIRY_DATE < CURRENT_DATE) ) 
		 )
		 AND ((C.REMOVAL_DATE IS NULL) OR  (C.REMOVAL_DATE > CURRENT_DATE)) 
	
		AND A.ENGLISH_HOME_ADDRESS_ID = ENG.UUID
		AND A.CHINESE_HOME_ADDRESS_ID = CHI.UUID
 
	  UNION all		 	 		 


 SELECT sys_guid(), 
	C.CERTIFICATION_NO,
	trim( APP.SURNAME||' '|| APP.GIVEN_NAME_ON_ID),
	trim(APP.CHINESE_NAME),	
	eng.address_line1 AS english_line1,
	eng.address_line2 AS english_line2,
	eng.address_line3 AS english_line3,
	eng.address_line4 AS english_line4,
	eng.address_line5 AS english_line5,
	chi.address_line1 AS chinese_line1,
	chi.address_line2 AS chinese_line2,
	chi.address_line3 AS chinese_line3,
	chi.address_line4 AS chinese_line4,
	chi.address_line5 AS chinese_line5,
  	A.FAX_NO1,
  	A.FAX_NO2
		 FROM  
		 c_IND_CERTIFICATE C, c_S_CATEGORY_CODE CAT, c_S_SYSTEM_VALUE CATGRP, 
		 c_APPLICANT APP, c_IND_APPLICATION A 
        ,c_S_SYSTEM_VALUE statusCode
        ,c_ADDRESS eng,  c_ADDRESS chi
		 WHERE  
		 C.CATEGORY_ID= cat.UUID 
		 AND C.MASTER_ID=A.UUID 
		 AND A.REGISTRATION_TYPE= 'IP'
		 AND CATGRP.UUID = CAT.CATEGORY_GROUP_ID  
 		 AND CATGRP.UUID=(SELECT  CATEGORY_GROUP_ID FROM c_S_CATEGORY_CODE SCC WHERE  SCC.CODE='RSE')
		 AND A.APPLICANT_ID =APP.UUID 
		 AND C.CERTIFICATION_NO IS NOT NULL 
		 AND statusCode.UUID=C.application_status_id 
			  AND (statusCode.CODE= '1' or (C.RETENTION_APPLICATION_DATE IS NOT NULL))
		
		 AND (  
		 (C.EXPIRY_DATE IS NOT NULL and C.EXPIRY_DATE >= CURRENT_DATE ) or 
		 (C.RETENTION_APPLICATION_DATE > TO_DATE('20040831', 'yyyymmdd') and (C.EXPIRY_DATE < CURRENT_DATE) ) 
		 )
		 AND ((C.REMOVAL_DATE IS NULL) OR  (C.REMOVAL_DATE > CURRENT_DATE)) 
		 	AND A.ENGLISH_HOME_ADDRESS_ID = ENG.UUID
		AND A.CHINESE_HOME_ADDRESS_ID = CHI.UUID
		
	   UNION all		 			 


 SELECT sys_guid(), 
	C.CERTIFICATION_NO,
	trim( APP.SURNAME||' '|| APP.GIVEN_NAME_ON_ID),
	trim(APP.CHINESE_NAME),	
	eng.address_line1 AS english_line1,
	eng.address_line2 AS english_line2,
	eng.address_line3 AS english_line3,
	eng.address_line4 AS english_line4,
	eng.address_line5 AS english_line5,
	chi.address_line1 AS chinese_line1,
	chi.address_line2 AS chinese_line2,
	chi.address_line3 AS chinese_line3,
	chi.address_line4 AS chinese_line4,
	chi.address_line5 AS chinese_line5,
  	A.FAX_NO1,
  	A.FAX_NO2
		 FROM  
		 c_IND_CERTIFICATE C, c_S_CATEGORY_CODE CAT, c_S_SYSTEM_VALUE CATGRP, 
		 c_APPLICANT APP, c_IND_APPLICATION A  ,c_S_SYSTEM_VALUE statusCode
		  ,c_ADDRESS eng,  c_ADDRESS chi
		 WHERE  
		 C.CATEGORY_ID= cat.UUID 
		 AND C.MASTER_ID=A.UUID 
		 AND A.REGISTRATION_TYPE= 'IP'
		 AND CATGRP.UUID = CAT.CATEGORY_GROUP_ID  
		  AND CATGRP.UUID=(SELECT  CATEGORY_GROUP_ID FROM c_S_CATEGORY_CODE SCC WHERE  SCC.CODE='RI(A)')
		 AND A.APPLICANT_ID =APP.UUID 
		 AND C.CERTIFICATION_NO IS NOT NULL 
		 AND statusCode.UUID=C.application_status_id 
			  AND (statusCode.CODE= '1' or (C.RETENTION_APPLICATION_DATE IS NOT NULL))
		
		 AND (  
		 (C.EXPIRY_DATE IS NOT NULL and C.EXPIRY_DATE >= CURRENT_DATE ) or 
		 (C.RETENTION_APPLICATION_DATE > TO_DATE('20040831', 'yyyymmdd') and (C.EXPIRY_DATE < CURRENT_DATE) ) 
		 )
		 AND ((C.REMOVAL_DATE IS NULL) OR  (C.REMOVAL_DATE > CURRENT_DATE)) 
			 	AND A.ENGLISH_HOME_ADDRESS_ID = ENG.UUID
		AND A.CHINESE_HOME_ADDRESS_ID = CHI.UUID
		

UNION all		 

SELECT 
		 sys_guid(), 
		 C.CERTIFICATION_NO,
		 C.ENGLISH_COMPANY_NAME , 
		 C.CHINESE_COMPANY_NAME, 
		 	eng.address_line1 AS english_line1,
	eng.address_line2 AS english_line2,
	eng.address_line3 AS english_line3,
	eng.address_line4 AS english_line4,
	eng.address_line5 AS english_line5,
	chi.address_line1 AS chinese_line1,
	chi.address_line2 AS chinese_line2,
	chi.address_line3 AS chinese_line3,
	chi.address_line4 AS chinese_line4,
	chi.address_line5 AS chinese_line5,
  	C.FAX_NO1,
  	C.FAX_NO2
		 
		 FROM  c_S_CATEGORY_CODE CAT, c_COMP_APPLICATION C 
	  	,c_ADDRESS eng,  c_ADDRESS chi
		 
		 WHERE  
		 CAT.UUID = C.CATEGORY_ID
		 AND C.CATEGORY_ID= (SELECT  UUID FROM c_S_CATEGORY_CODE SCC WHERE  SCC.CODE='GBC')
		 AND C.REGISTRATION_TYPE= 'CGC'  
		 AND C.CERTIFICATION_NO IS NOT NULL   
		 AND  ( (C.EXPIRY_DATE IS NOT NULL and  C.EXPIRY_DATE >= CURRENT_DATE) or 
				( (C.RETENTION_APPLICATION_DATE > TO_DATE('20040831', 'yyyymmdd') and (C.EXPIRY_DATE < CURRENT_DATE) ) )
		 ) 
		 AND ((C.REMOVAL_DATE IS NULL) OR  
			  (C.REMOVAL_DATE > CURRENT_DATE) 
			 )   
			
		   	AND C.ENGLISH_ADDRESS_ID = ENG.UUID
		AND C.CHINESE_ADDRESS_ID = CHI.UUID	

UNION all		 
			 
SELECT 
		sys_guid(),
		C.CERTIFICATION_NO, 
		C.ENGLISH_COMPANY_NAME ,
		C.CHINESE_COMPANY_NAME, 


	eng.address_line1 AS english_line1,
	eng.address_line2 AS english_line2,
	eng.address_line3 AS english_line3,
	eng.address_line4 AS english_line4,
	eng.address_line5 AS english_line5,
	chi.address_line1 AS chinese_line1,
	chi.address_line2 AS chinese_line2,
	chi.address_line3 AS chinese_line3,
	chi.address_line4 AS chinese_line4,
	chi.address_line5 AS chinese_line5,
  	C.FAX_NO1,
  	C.FAX_NO2


		FROM  c_S_CATEGORY_CODE CAT, c_COMP_APPLICATION C, 	 c_COMP_APPLICANT_INFO APP_INFO, c_APPLICANT APP,  
		c_S_SYSTEM_VALUE S_ROLE, c_S_SYSTEM_VALUE S_STATUS 
			,c_ADDRESS eng,  c_ADDRESS chi
		WHERE  
		C.CATEGORY_ID = CAT.UUID
		AND C.UUID=APP_INFO.MASTER_ID 
		AND APP_INFO.APPLICANT_ID=APP.UUID 
		AND APP_INFO.APPLICANT_ROLE_ID=S_ROLE.UUID 
		AND APP_INFO.APPLICANT_STATUS_ID= S_STATUS.UUID 
		AND C.REGISTRATION_TYPE= 'CMW'
		AND S_ROLE.CODE LIKE 'A%' 
		AND S_STATUS.CODE= '1'
		AND APP_INFO.accept_date IS NOT NULL 
		AND ( (APP_INFO.REMOVAL_DATE IS NULL) OR  (APP_INFO.REMOVAL_DATE < CURRENT_DATE) )  
		AND C.CERTIFICATION_NO IS NOT NULL AND (  
		 (C.EXPIRY_DATE IS NOT NULL and  C.EXPIRY_DATE >= CURRENT_DATE) or      
			 ( (C.RETENTION_APPLICATION_DATE > TO_DATE('20040831', 'yyyymmdd') and  
			   (C.EXPIRY_DATE < CURRENT_DATE) ) ) )  AND ((C.REMOVAL_DATE IS NULL) OR      
		   (C.REMOVAL_DATE > CURRENT_DATE)) 
		and APP_INFO.uuid in ( 
		select cwi.COMPANY_APPLICANTS_ID  
		from c_COMP_APPLICANT_MW_ITEM cwi  
		--inner join COMP_APPLICANT_INFO_DETAIL cinfod on cinfod.COMPANY_APPLICANTS_MASTER_ID = cinfom.uuid  
		inner join c_s_system_value mwcode on cwi.ITEM_TYPE_ID = mwcode.uuid  
		where mwcode.code in('Type A'))   
			AND C.ENGLISH_ADDRESS_ID = ENG.UUID
		AND C.CHINESE_ADDRESS_ID = CHI.UUID	
			 
			 
		 UNION all		
  
SELECT  	 
		 
		 sys_guid(), 
	C.CERTIFICATION_NO,
	trim( APP.SURNAME||' '|| APP.GIVEN_NAME_ON_ID),
	trim(APP.CHINESE_NAME),	
	eng.address_line1 AS english_line1,
	eng.address_line2 AS english_line2,
	eng.address_line3 AS english_line3,
	eng.address_line4 AS english_line4,
	eng.address_line5 AS english_line5,
	chi.address_line1 AS chinese_line1,
	chi.address_line2 AS chinese_line2,
	chi.address_line3 AS chinese_line3,
	chi.address_line4 AS chinese_line4,
	chi.address_line5 AS chinese_line5,
  	A.FAX_NO1,
  	A.FAX_NO2
		 
		 
		 FROM  c_S_category_code cat, c_IND_CERTIFICATE C, c_APPLICANT APP, c_IND_APPLICATION A, c_S_SYSTEM_VALUE SV  
		 	,c_ADDRESS eng,  c_ADDRESS chi
		 WHERE  C.CATEGORY_ID = CAT.UUID
	    	AND C.MASTER_ID=A.UUID 
		 AND A.APPLICANT_ID =APP.UUID  
		 AND A.REGISTRATION_TYPE= 'IMW' 
		 AND SV.UUID=C.application_status_id 
	 	 AND (SV.CODE= '1' or (C.RETENTION_APPLICATION_DATE IS NOT NULL))
		 
		 AND C.CERTIFICATION_NO IS NOT NULL  
		 AND  
		 (  (C.EXPIRY_DATE IS NOT NULL and C.EXPIRY_DATE >= CURRENT_DATE ) or  
			(C.RETENTION_APPLICATION_DATE > TO_DATE('20040831', 'yyyymmdd') and (C.EXPIRY_DATE < CURRENT_DATE) ) 
		 ) 
		 AND  
		 ( (C.REMOVAL_DATE IS NULL) OR  (C.REMOVAL_DATE > CURRENT_DATE))  
		 AND A.UUID IN (  
		 SELECT distinct iitem.MASTER_ID FROM c_ind_application_mw_item iitem, c_s_system_value sitem  
		 WHERE iitem.ITEM_DETAILS_ID = sitem.UUID  
		 AND sitem.code in('Item 3.6'))  
		 
		 	AND A.ENGLISH_HOME_ADDRESS_ID = ENG.UUID
		AND A.CHINESE_HOME_ADDRESS_ID = CHI.UUID
)alls
ORDER BY CERTIFICATION_NO, english_name
);

